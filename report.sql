use master;
GO
DROP database IF EXISTS DBREPORT;
CREATE DATABASE DBREPORT;
GO
USE DBREPORT;
GO
set language spanish;
GO

CREATE TABLE ACTIVIDADES (
    IDACT int  NOT NULL IDENTITY(1,1), --id identificador
    NOMACT varchar(60)  NOT NULL, -- nombre de la actividad
    MONESPACT int  NOT NULL, -- monto por actividad
    FECACT date  NOT NULL,  -- fecha de la actividad
    ESTACT char(1) DEFAULT 'A'  NOT NULL, -- estado
    CONSTRAINT ACTIVIDAD_pk PRIMARY KEY  (IDACT) 
);
GO
INSERT INTO ACTIVIDADES(NOMACT,MONESPACT,FECACT) 
VALUES	('ANIVERSARIO','70','2021-12-05'),
		('ANIVERSARIO','60','2021-12-05'),
		('ANIVERSARIO','50','2021-12-05'),
		('ANIVERSARIO','40','2021-12-05'),
		('PINTADO','50','2021-05-11'),
		('PINTADO','60','2021-12-05'),
		('PINTADO','70','2021-12-05'),
		('PINTADO','40','2021-05-11'),
		('PINTADO','30','2021-05-11'),
		('MANTENIMIENTO','50','2021-05-11'),
		('MANTENIMIENTO','60','2021-12-14'),
		('MANTENIMIENTO','70','2021-05-11'),
		('MANTENIMIENTO','80','2021-12-14'),
		('MANTENIMIENTO','90','2021-12-14'),
		('EXCURSION','30','2021-12-14'),
		('EXCURSION','40','2021-12-05'),
		('EXCURSION','50','2021-12-05'),
		('EXCURSION','60','2021-12-14'),
		('EXCURSION','70','2021-12-05'),
		('MANTENIMIENTO','50','2021-03-16'),
		('MANTENIMIENTO','60','2021-05-20'),
		('MANTENIMIENTO','70','2021-05-20'),
		('MANTENIMIENTO','80','2021-03-16'),
		('REPARAR CARPETAS','20','2021-03-16'),
		('REPARAR CARPETAS','30','2021-05-20'),
		('REPARAR CARPETAS','10','2021-05-20'),
		('REPARAR CARPETAS','60','2021-03-16'),
		('COMPRAR PODADORAS DE CESPED','40','2021-05-20'),
		('COMPRAR PODADORAS DE CESPED','30','2021-05-20'),
		('COMPRAR PODADORAS DE CESPED','20','2021-03-16'),
		('COMPRAR PODADORAS DE CESPED','100','2021-03-16'),
		('COMPRAR PODADORAS DE CESPED','10','2021-05-20');
GO
INSERT INTO ACTIVIDADES(NOMACT,MONESPACT,FECACT,ESTACT) 
VALUES
		('REPARAR COMPUTADORAS','70','2021-09-25','I'),
		('REPARAR COMPUTADORAS','60','2021-05-27','I'),
		('REPARAR COMPUTADORAS','50','2021-05-27','I'),
		('REPARAR COMPUTADORAS','40','2021-09-25','I'),
		('PROFESOR DE MUSICA','30','2021-05-27','I'),
		('PROFESOR DE MUSICA','50','2021-09-25','I'),
		('PROFESOR DE MUSICA','40','2021-09-25','I'),
		('PROFESOR DE MUSICA','100','2021-05-27','I');
GO

select* from ACTIVIDADES;
DROP VIEW V_ACTIVIDADES;
-- VISTA DE LA TABLA
CREATE VIEW V_ACTIVIDADES AS
select IDACT,NOMACT, MONESPACT, FECACT,ESTACT, case ESTACT
when 'A' then 'ACTIVO'  
when 'I' then 'INACTIVO' 
END AS ESTADO
FROM ACTIVIDADES;

CREATE VIEW V_FECHA AS
select distinct CONVERT(VARCHAR(10), FECACT, 120) as FECHACO from ACTIVIDADES;



select* from V_ACTIVIDADES WHERE FECACT BETWEEN '2021-12-11' AND '2021-12-14' ORDER BY IDACT DESC ;

SELECT * FROM V_FECHA;

select* from V_ACTIVIDADES WHERE FECACT='2021-03-16';

select IDACT, ESTADO from V_ACTIVIDADES;
select IDACT, NOMACT from V_ACTIVIDADES;